import random
import pandas as pd

accounts_df = pd.DataFrame(columns=['first_name', 'last_name', 'account_number', 'PIN', 'balance'])

while True:
    print("Welcome to AHI Bank")

    print("1. Create an account")

    print("2. Log into account")

    print("3. Make a transaction")
    
    try:
        choice = int(input("Enter your choice: "))
    except ValueError:
        print("Invalid input. Please enter a number.")
    
    if choice == 1:
        print("Creating an account")

        first_name = input("Enter your first name: ")

        last_name = input("Enter your last name: ")

        balance_acc = 0

        account_number = random.randint(10000000, 99999999)

        PIN = int(input("Enter your PIN code: "))

        print("Your account number is: ", account_number)

        print("Your balance is: ", balance_acc)

        balance = [balance_acc]

        new_account = {'first_name': first_name, 'last_name': last_name, 'account_number': account_number, 'PIN': PIN, 'balance': balance}

        accounts_df = pd.concat([accounts_df, pd.DataFrame(new_account)], ignore_index=True)
    
    elif choice == 2:
        print("Logging into account")

        account = int(input("Enter your account number: "))

        PIN_code = int(input("Enter your PIN code: "))

        index = accounts_df[accounts_df['account_number'] == account].index[0]
        
        if account == accounts_df['account_number'][index] and PIN_code == accounts_df['PIN'][index]:
            print("You are logged in")

            print('Hello', accounts_df['first_name'][index], accounts_df['last_name'][index])

            print("1. Check balance")

            print("2. Deposit")

            print("3. Withdraw")

            print("4. Transfer")
            
            try:
                choice = int(input("Enter your choice: "))
            except ValueError:
                print("Invalid input. Please enter a number.")
            
            if choice == 1:
                print("Your current balance is: ", accounts_df['balance'][index])
            
            elif choice == 2:
                amount = int(input("Enter the amount you want to deposit: "))

                accounts_df['balance'][index] += amount

                print("Your current balance is: ", accounts_df['balance'][index])
            
            elif choice == 3:  
                amount = int(input("Enter the amount you want to withdraw: "))

                if amount > accounts_df['balance'][index]:
                    print("Insufficient funds")
                else:
                    accounts_df['balance'][index] -= amount

                    print("Your current balance is: ", accounts_df['balance'][index])
            
            elif choice == 4:
                account_number = int(input("Enter the account number you want to transfer to: "))

                amount = int(input("Enter the amount you want to transfer: "))

                index2 = accounts_df[accounts_df['account_number'] == account_number].index[0]

                if amount > accounts_df['balance'][index]:
                    print("Insufficient funds")
                else:
                    accounts_df['balance'][index] -= amount

                    accounts_df['balance'][index2] += amount

                    print('You have successfully transferred', amount, 'to account number', account_number)

                    print("Your current balance is: ", accounts_df['balance'][index])
        else:
            print("Your account number or PIN code is incorrect")
    
    elif choice == 3:
        print("Making a transaction")

        account_number = int(input("Enter your account number: "))

        PIN_code = int(input("Enter your PIN code: "))

        index = accounts_df[accounts_df['account_number'] == account_number].index[0]
        
        if account_number == accounts_df['account_number'][index] and PIN_code == accounts_df['PIN'][index]:
            print("You are logged in")

            account_number = int(input("Enter the account number you want to transfer to: "))

            amount = int(input("Enter the amount you want to transfer: "))

            index2 = accounts_df[accounts_df['account_number'] == account_number].index[0]
            
            if amount > accounts_df['balance'][index]:
                print("Insufficient funds")
            else:
                accounts_df['balance'][index] -= amount

                accounts_df['balance'][index2] += amount

                print('You have successfully transferred', amount, 'to account number', account_number)        

                print("Your current balance is: ", accounts_df['balance'][index])
        else:
            print("Your account number or PIN code is incorrect")
    
    print("Do you want to perform another transaction?")

    print("1. Yes")

    print("2. No") 

    user_input = int(input("Enter your choice: "))
    
    if user_input != 1:
        break

print("Thank you for using AHI Bank")